{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/iKlejdi/Desktop/construction/frontend/src/hooks/useAuthGuard.ts"],"sourcesContent":["\"use client\";\n\nimport { useEffect } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useAuth } from \"../context/AuthContext\";\n\n/**\n * Reusable hook to protect pages from unauthorized access.\n * Redirects to /not_authorized if user is not logged in.\n */\n\nexport const useAuthGuard = () => {\n\tconst { user, loading } = useAuth();\n\tconst router = useRouter();\n\n\tuseEffect(() => {\n\t\tif (!loading && !user) {\n\t\trouter.push(\"/not_authorized\");\n\t\t}\n\t}, [user, loading, router]);\n\n\treturn { user, loading };\n};"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AAWO,MAAM,eAAe;;IAC3B,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,IAAA,4IAAO;IACjC,MAAM,SAAS,IAAA,kJAAS;IAExB,IAAA,0KAAS;kCAAC;YACT,IAAI,CAAC,WAAW,CAAC,MAAM;gBACvB,OAAO,IAAI,CAAC;YACZ;QACD;iCAAG;QAAC;QAAM;QAAS;KAAO;IAE1B,OAAO;QAAE;QAAM;IAAQ;AACxB;GAXa;;QACc,4IAAO;QAClB,kJAAS","debugId":null}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file:///Users/iKlejdi/Desktop/construction/frontend/src/app/projects/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { useAuth } from \"../../context/AuthContext\";\nimport { useAuthGuard } from \"../../hooks/useAuthGuard\";\nimport axios from \"axios\";\n\ninterface Project {\n  id: number;\n  name: string;\n  location: string;\n  description: string;\n  offer: number;\n  total: number;\n}\n\nexport default function ProjectsPage() {\n  const { token } = useAuth();\n  const [projects, setProjects] = useState<Project[]>([]);\n  const [modalProject, setModalProject] = useState<Project | null>(null);\n  const [isEdit, setIsEdit] = useState(false);\n\tconst { user, loading } = useAuthGuard();\n\n\n  const fetchProjects = async () => {\n    if (!token) return;\n    try {\n      const res = await axios.get(\"http://localhost:4000/projects\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      setProjects(res.data);\n    } catch (err) {\n      console.log(\"Failed to fetch projects\");\n    }\n  };\n\n  useEffect(() => {\n    fetchProjects();\n  }, [token]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!modalProject) return;\n\n    try {\n      if (isEdit) {\n        await axios.put(\n          `http://localhost:4000/projects/${modalProject.id}`,\n          modalProject,\n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n      } else {\n        await axios.post(\n          \"http://localhost:4000/projects\",\n          modalProject,\n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n      }\n      setModalProject(null);\n      fetchProjects();\n      const modalEl = document.getElementById(\"projectModal\");\n      if (modalEl) (window as any).bootstrap.Modal.getInstance(modalEl)?.hide();\n    } catch (err) {\n      alert(\"Failed to save project\");\n    }\n  };\n\n  const handleDelete = async (id: number) => {\n    if (!confirm(\"Are you sure?\")) return;\n    try {\n      await axios.delete(`http://localhost:4000/projects/${id}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      fetchProjects();\n    } catch (err) {\n      alert(\"Failed to delete project\");\n    }\n  };\n\n  \tif (loading) return <p>Checking authentication...</p>;\n\tif (!user) return <p>Redirecting...</p>;\n  return (\n    <div className=\"container py-5\">\n      <h2>Projects</h2>\n      <button\n        className=\"btn btn-success mb-3\"\n        data-bs-toggle=\"modal\"\n        data-bs-target=\"#projectModal\"\n        onClick={() =>\n          setModalProject({\n            id: 0,\n            name: \"\",\n            location: \"\",\n            description: \"\",\n            offer: 0,\n            total: 0,\n          })\n        }\n      >\n        Add Project\n      </button>\n\n      <table className=\"table table-striped\">\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Location</th>\n            <th>Description</th>\n            <th>Offer</th>\n            <th>Total</th>\n            <th>Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          {projects.map((proj) => (\n            <tr key={proj.id}>\n              <td>{proj.name}</td>\n              <td>{proj.location}</td>\n              <td>{proj.description}</td>\n              <td>{proj.offer}</td>\n              <td>{proj.total}</td>\n              <td>\n                <button\n                  className=\"btn btn-primary me-2\"\n                  data-bs-toggle=\"modal\"\n                  data-bs-target=\"#projectModal\"\n                  onClick={() => {\n                    setModalProject(proj);\n                    setIsEdit(true);\n                  }}\n                >\n                  Edit\n                </button>\n                <button className=\"btn btn-danger\" onClick={() => handleDelete(proj.id)}>\n                  Delete\n                </button>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n\n      {/* Modal */}\n      <div className=\"modal fade\" id=\"projectModal\" tabIndex={-1} aria-hidden=\"true\">\n        <div className=\"modal-dialog\">\n          <form className=\"modal-content\" onSubmit={handleSubmit}>\n            <div className=\"modal-header\">\n              <h5 className=\"modal-title\">{isEdit ? \"Edit\" : \"Add\"} Project</h5>\n              <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n            <div className=\"modal-body\">\n              <input\n                type=\"text\"\n                className=\"form-control mb-2\"\n                placeholder=\"Name\"\n                value={modalProject?.name || \"\"}\n                onChange={(e) =>\n                  setModalProject((prev) => ({ ...prev!, name: e.target.value }))\n                }\n                required\n              />\n              <input\n                type=\"text\"\n                className=\"form-control mb-2\"\n                placeholder=\"Location\"\n                value={modalProject?.location || \"\"}\n                onChange={(e) =>\n                  setModalProject((prev) => ({ ...prev!, location: e.target.value }))\n                }\n                required\n              />\n              <textarea\n                className=\"form-control mb-2\"\n                placeholder=\"Description\"\n                value={modalProject?.description || \"\"}\n                onChange={(e) =>\n                  setModalProject((prev) => ({ ...prev!, description: e.target.value }))\n                }\n              />\n              <input\n                type=\"number\"\n                className=\"form-control mb-2\"\n                placeholder=\"Offer\"\n                value={modalProject?.offer || 0}\n                onChange={(e) =>\n                  setModalProject((prev) => ({ ...prev!, offer: Number(e.target.value) }))\n                }\n              />\n              <input\n                type=\"number\"\n                className=\"form-control mb-2\"\n                placeholder=\"Total\"\n                value={modalProject?.total || 0}\n                onChange={(e) =>\n                  setModalProject((prev) => ({ ...prev!, total: Number(e.target.value) }))\n                }\n              />\n            </div>\n            <div className=\"modal-footer\">\n              <button type=\"button\" className=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\n                Close\n              </button>\n              <button type=\"submit\" className=\"btn btn-primary\">\n                {isEdit ? \"Save Changes\" : \"Add Project\"}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/iKlejdi/Desktop/construction/frontend/src/app/invoices/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { useAuth } from \"../../context/AuthContext\";\nimport axios from \"axios\";\n\ninterface Invoice {\n  id: number;\n  projectId: number;\n  amount: number;\n  date: string;\n}\n\nexport default function InvoicesPage() {\n  const { token, user } = useAuth();\n  const [invoices, setInvoices] = useState<Invoice[]>([]);\n  const [modalInvoice, setModalInvoice] = useState<Invoice | null>(null);\n  const [isEdit, setIsEdit] = useState(false);\n\n  const fetchInvoices = async () => {\n    if (!token) return;\n    try {\n      const res = await axios.get(\"http://localhost:4000/invoices\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      setInvoices(res.data);\n    } catch (err) {\n      alert(\"Failed to fetch invoices\");\n    }\n  };\n\n  useEffect(() => {\n    fetchInvoices();\n  }, [token]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!modalInvoice) return;\n\n    try {\n      if (isEdit) {\n        await axios.put(\n          `http://localhost:4000/invoices/${modalInvoice.id}`,\n          modalInvoice,\n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n      } else {\n        await axios.post(\n          \"http://localhost:4000/invoices\",\n          modalInvoice,\n          { headers: { Authorization: `Bearer ${token}` } }\n        );\n      }\n      setModalInvoice(null);\n      fetchInvoices();\n      const modalEl = document.getElementById(\"invoiceModal\");\n      if (modalEl) (window as any).bootstrap.Modal.getInstance(modalEl)?.hide();\n    } catch (err) {\n      alert(\"Failed to save invoice\");\n    }\n  };\n\n  const handleDelete = async (id: number) => {\n    if (!confirm(\"Are you sure?\")) return;\n    try {\n      await axios.delete(`http://localhost:4000/invoices/${id}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      fetchInvoices();\n    } catch (err) {\n      alert(\"Failed to delete invoice\");\n    }\n  };\n\n  return (\n    <div className=\"container py-5\">\n      <h2>Invoices {user && `- Welcome, ${user.name}`}</h2>\n      <button\n        className=\"btn btn-success mb-3\"\n        data-bs-toggle=\"modal\"\n        data-bs-target=\"#invoiceModal\"\n        onClick={() =>\n          setModalInvoice({ id: 0, projectId: 0, amount: 0, date: \"\" })\n        }\n      >\n        Add Invoice\n      </button>\n\n      <table className=\"table table-striped\">\n        <thead>\n          <tr>\n            <th>Project ID</th>\n            <th>Amount</th>\n            <th>Date</th>\n            <th>Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          {invoices.map((inv) => (\n            <tr key={inv.id}>\n              <td>{inv.projectId}</td>\n              <td>{inv.amount}</td>\n              <td>{inv.date}</td>\n              <td>\n                <button\n                  className=\"btn btn-primary me-2\"\n                  data-bs-toggle=\"modal\"\n                  data-bs-target=\"#invoiceModal\"\n                  onClick={() => {\n                    setModalInvoice(inv);\n                    setIsEdit(true);\n                  }}\n                >\n                  Edit\n                </button>\n                <button className=\"btn btn-danger\" onClick={() => handleDelete(inv.id)}>\n                  Delete\n                </button>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n\n      {/* Modal */}\n      <div className=\"modal fade\" id=\"invoiceModal\" tabIndex={-1} aria-hidden=\"true\">\n        <div className=\"modal-dialog\">\n          <form className=\"modal-content\" onSubmit={handleSubmit}>\n            <div className=\"modal-header\">\n              <h5 className=\"modal-title\">{isEdit ? \"Edit\" : \"Add\"} Invoice</h5>\n              <button type=\"button\" className=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n            <div className=\"modal-body\">\n              <input\n                type=\"number\"\n                className=\"form-control mb-2\"\n                placeholder=\"Project ID\"\n                value={modalInvoice?.projectId || 0}\n                onChange={(e) =>\n                  setModalInvoice((prev) => ({ ...prev!, projectId: Number(e.target.value) }))\n                }\n                required\n              />\n              <input\n                type=\"number\"\n                className=\"form-control mb-2\"\n                placeholder=\"Amount\"\n                value={modalInvoice?.amount || 0}\n                onChange={(e) =>\n                  setModalInvoice((prev) => ({ ...prev!, amount: Number(e.target.value) }))\n                }\n                required\n              />\n              <input\n                type=\"date\"\n                className=\"form-control mb-2\"\n                value={modalInvoice?.date || \"\"}\n                onChange={(e) =>\n                  setModalInvoice((prev) => ({ ...prev!, date: e.target.value }))\n                }\n                required\n              />\n            </div>\n            <div className=\"modal-footer\">\n              <button type=\"button\" className=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\n                Close\n              </button>\n              <button type=\"submit\" className=\"btn btn-primary\">\n                {isEdit ? \"Save Changes\" : \"Add Invoice\"}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;AAHA;;;;AAYe,SAAS;;IACtB,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,IAAA,4IAAO;IAC/B,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAY,EAAE;IACtD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAiB;IACjE,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IAErC,MAAM,gBAAgB;QACpB,IAAI,CAAC,OAAO;QACZ,IAAI;YACF,MAAM,MAAM,MAAM,mJAAK,CAAC,GAAG,CAAC,kCAAkC;gBAC5D,SAAS;oBAAE,eAAe,AAAC,UAAe,OAAN;gBAAQ;YAC9C;YACA,YAAY,IAAI,IAAI;QACtB,EAAE,OAAO,KAAK;YACZ,MAAM;QACR;IACF;IAEA,IAAA,0KAAS;kCAAC;YACR;QACF;iCAAG;QAAC;KAAM;IAEV,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,IAAI,CAAC,cAAc;QAEnB,IAAI;gBAiBW;YAhBb,IAAI,QAAQ;gBACV,MAAM,mJAAK,CAAC,GAAG,CACb,AAAC,kCAAiD,OAAhB,aAAa,EAAE,GACjD,cACA;oBAAE,SAAS;wBAAE,eAAe,AAAC,UAAe,OAAN;oBAAQ;gBAAE;YAEpD,OAAO;gBACL,MAAM,mJAAK,CAAC,IAAI,CACd,kCACA,cACA;oBAAE,SAAS;wBAAE,eAAe,AAAC,UAAe,OAAN;oBAAQ;gBAAE;YAEpD;YACA,gBAAgB;YAChB;YACA,MAAM,UAAU,SAAS,cAAc,CAAC;YACxC,IAAI,UAAS,+BAAA,AAAC,OAAe,SAAS,CAAC,KAAK,CAAC,WAAW,CAAC,sBAA5C,mDAAA,6BAAsD,IAAI;QACzE,EAAE,OAAO,KAAK;YACZ,MAAM;QACR;IACF;IAEA,MAAM,eAAe,OAAO;QAC1B,IAAI,CAAC,QAAQ,kBAAkB;QAC/B,IAAI;YACF,MAAM,mJAAK,CAAC,MAAM,CAAC,AAAC,kCAAoC,OAAH,KAAM;gBACzD,SAAS;oBAAE,eAAe,AAAC,UAAe,OAAN;gBAAQ;YAC9C;YACA;QACF,EAAE,OAAO,KAAK;YACZ,MAAM;QACR;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;;oBAAG;oBAAU,QAAQ,AAAC,cAAuB,OAAV,KAAK,IAAI;;;;;;;0BAC7C,6LAAC;gBACC,WAAU;gBACV,kBAAe;gBACf,kBAAe;gBACf,SAAS,IACP,gBAAgB;wBAAE,IAAI;wBAAG,WAAW;wBAAG,QAAQ;wBAAG,MAAM;oBAAG;0BAE9D;;;;;;0BAID,6LAAC;gBAAM,WAAU;;kCACf,6LAAC;kCACC,cAAA,6LAAC;;8CACC,6LAAC;8CAAG;;;;;;8CACJ,6LAAC;8CAAG;;;;;;8CACJ,6LAAC;8CAAG;;;;;;8CACJ,6LAAC;8CAAG;;;;;;;;;;;;;;;;;kCAGR,6LAAC;kCACE,SAAS,GAAG,CAAC,CAAC,oBACb,6LAAC;;kDACC,6LAAC;kDAAI,IAAI,SAAS;;;;;;kDAClB,6LAAC;kDAAI,IAAI,MAAM;;;;;;kDACf,6LAAC;kDAAI,IAAI,IAAI;;;;;;kDACb,6LAAC;;0DACC,6LAAC;gDACC,WAAU;gDACV,kBAAe;gDACf,kBAAe;gDACf,SAAS;oDACP,gBAAgB;oDAChB,UAAU;gDACZ;0DACD;;;;;;0DAGD,6LAAC;gDAAO,WAAU;gDAAiB,SAAS,IAAM,aAAa,IAAI,EAAE;0DAAG;;;;;;;;;;;;;+BAhBnE,IAAI,EAAE;;;;;;;;;;;;;;;;0BA0BrB,6LAAC;gBAAI,WAAU;gBAAa,IAAG;gBAAe,UAAU,CAAC;gBAAG,eAAY;0BACtE,cAAA,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAK,WAAU;wBAAgB,UAAU;;0CACxC,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAG,WAAU;;4CAAe,SAAS,SAAS;4CAAM;;;;;;;kDACrD,6LAAC;wCAAO,MAAK;wCAAS,WAAU;wCAAY,mBAAgB;;;;;;;;;;;;0CAE9D,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCACC,MAAK;wCACL,WAAU;wCACV,aAAY;wCACZ,OAAO,CAAA,yBAAA,mCAAA,aAAc,SAAS,KAAI;wCAClC,UAAU,CAAC,IACT,gBAAgB,CAAC,OAAS,CAAC;oDAAE,GAAG,IAAI;oDAAG,WAAW,OAAO,EAAE,MAAM,CAAC,KAAK;gDAAE,CAAC;wCAE5E,QAAQ;;;;;;kDAEV,6LAAC;wCACC,MAAK;wCACL,WAAU;wCACV,aAAY;wCACZ,OAAO,CAAA,yBAAA,mCAAA,aAAc,MAAM,KAAI;wCAC/B,UAAU,CAAC,IACT,gBAAgB,CAAC,OAAS,CAAC;oDAAE,GAAG,IAAI;oDAAG,QAAQ,OAAO,EAAE,MAAM,CAAC,KAAK;gDAAE,CAAC;wCAEzE,QAAQ;;;;;;kDAEV,6LAAC;wCACC,MAAK;wCACL,WAAU;wCACV,OAAO,CAAA,yBAAA,mCAAA,aAAc,IAAI,KAAI;wCAC7B,UAAU,CAAC,IACT,gBAAgB,CAAC,OAAS,CAAC;oDAAE,GAAG,IAAI;oDAAG,MAAM,EAAE,MAAM,CAAC,KAAK;gDAAC,CAAC;wCAE/D,QAAQ;;;;;;;;;;;;0CAGZ,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAO,MAAK;wCAAS,WAAU;wCAAoB,mBAAgB;kDAAQ;;;;;;kDAG5E,6LAAC;wCAAO,MAAK;wCAAS,WAAU;kDAC7B,SAAS,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ3C;GAnKwB;;QACE,4IAAO;;;KADT","debugId":null}}]
}